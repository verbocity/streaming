package com.ing.streaming.utils

import java.io.{Reader, File}
import java.text.{DecimalFormat, NumberFormat}
import java.util.{Locale, Properties, Random}

import scala.collection.mutable
import scala.io.Source
import scala.collection.immutable.{Map => iMap}
import scala.collection.mutable.{Map => mMap}
import scala.collection.JavaConverters._

object Utils {
	/** Configures the Oauth Credentials for accessing Twitter */
	def configureTwitterCredentials() {
		val file = new File("credentials.txt")

		println(file.getAbsolutePath)

		if (!file.exists) {
			throw new Exception("Could not find configuration file " + file)
		}

		val lines = Source.fromFile(file.toString).getLines().filter(_.trim.size > 0).toSeq
		val pairs = lines.map(line => {
			val splits = line.split("=")

			if (splits.size != 2) {
				throw new Exception("Error parsing configuration file - incorrectly formatted line [" + line + "]")
			}

			(splits(0).trim(), splits(1).trim())
		})

		val map = new mutable.HashMap[String, String] ++= pairs
		val configKeys = Seq("consumerKey", "consumerSecret", "accessToken", "accessTokenSecret")

		configKeys.foreach(key => {
			if (!map.contains(key)) {
				throw new Exception("Error setting OAuth authenticaion - value for " + key + " not found")
			}

			val fullKey = "twitter4j.oauth." + key
			System.setProperty(fullKey, map(key))
		})

		println()
	}

	def createNetherlandsMunicipalityCounts(): iMap[String, Int] = {
		mapToRandom(List(
			"nl-fr-gm0088", "nl-3557-gm0363", "nl-3557-gm0448", "nl-gr-gm1651",
			"nl-ze-gm1676", "nl-fr-gm1900", "nl-3560-gm1924", "nl-gr-gm0007",
			"nl-fl-gm0050", "nl-fl-gm0034", "nl-ge-gm0267", "nl-ge-gm0203",
			"nl-3559-gm0307", "nl-3559-gm0308", "nl-3557-gm0432", "nl-3557-gm1911",
			"nl-3557-gm0398", "nl-ov-gm0153", "nl-3557-gm0394", "nl-3557-gm0358",
			"nl-3560-gm0585", "nl-3560-gm0617", "nl-3560-gm0629", "nl-3560-gm0523",
			"nl-3560-gm0689", "nl-li-gm1640", "nl-3558-gm0828", "nl-3558-gm1721",
			"nl-3559-gm0632", "nl-3560-gm1901", "nl-3560-gm0599", "nl-3560-gm0612",
			"nl-3560-gm0614", "nl-ov-gm1774", "nl-ge-gm1586", "nl-ge-gm0197",
			"nl-ge-gm1859", "nl-fr-gm0079", "nl-fr-gm0058", "nl-fr-gm0072",
			"nl-fr-gm0093", "nl-ov-gm0166", "nl-ov-gm0193", "nl-ge-gm0244",
			"nl-ge-gm0269", "nl-fl-gm0171", "nl-fl-gm0184", "nl-ov-gm1708",
			"nl-fl-gm0303", "nl-ge-gm0302", "nl-3557-gm0392", "nl-3557-gm0479",
			"nl-3557-gm0431", "nl-3557-gm0437", "nl-3559-gm0736", "nl-3557-gm0417",
			"nl-3557-gm0376", "nl-3559-gm0317", "nl-3557-gm0420", "nl-3557-gm0405",
			"nl-3557-gm1598", "nl-3557-gm0424", "nl-3557-gm0453", "nl-3557-gm0375",
			"nl-ze-gm0664", "nl-ze-gm0654", "nl-ze-gm1695", "nl-ze-gm0687",
			"nl-ze-gm0677", "nl-3558-gm0748", "nl-ze-gm0716", "nl-ze-gm0717",
			"nl-3558-gm1723", "nl-3558-gm0744", "nl-fl-gm0995", "nl-3557-gm0388",
			"nl-gr-gm0005", "nl-gr-gm1663", "nl-gr-gm0053", "nl-gr-gm0056",
			"nl-3558-gm1709", "nl-3558-gm1655", "nl-3558-gm1719", "nl-gr-gm1895",
			"nl-gr-gm1987", "nl-gr-gm0040", "nl-fr-gm0140", "nl-fr-gm0055",
			"nl-fr-gm0051", "nl-fr-gm0653", "nl-3558-gm1671", "nl-gr-gm0010",
			"nl-gr-gm0024", "nl-gr-gm0003", "nl-fr-gm1891", "nl-fr-gm1722",
			"nl-fr-gm0096", "nl-ov-gm1896", "nl-ge-gm0232", "nl-fr-gm0082",
			"nl-ge-gm0230", "nl-ge-gm0243", "nl-ge-gm0233", "nl-ge-gm0273",
			"nl-3559-gm0313", "nl-3557-gm0451", "nl-3557-gm0362", "nl-3557-gm0415",
			"nl-3557-gm0384", "nl-3557-gm0532", "nl-3557-gm0457", "nl-3557-gm0425",
			"nl-3557-gm0381", "nl-3557-gm0402", "nl-3557-gm0406", "nl-3557-gm0377",
			"nl-3560-gm0588", "nl-3560-gm0584", "nl-ze-gm0718", "nl-ze-gm0678",
			"nl-ze-gm0715", "nl-ze-gm1714", "nl-3558-gm0851", "nl-3558-gm1674",
			"nl-3558-gm0826", "nl-3558-gm0758", "nl-3560-gm1783", "nl-3560-gm0518",
			"nl-3560-gm0556", "nl-3560-gm1842", "nl-gr-gm0765", "nl-fr-gm0070",
			"nl-3557-gm0373", "nl-3557-gm0441", "nl-gr-gm0009", "nl-gr-gm0014",
			"nl-fr-gm0059", "nl-fr-gm1908", "nl-fr-gm0063", "nl-gr-gm0022",
			"nl-fr-gm0086", "nl-gr-gm0015", "nl-fr-gm0090", "nl-gr-gm0025",
			"nl-ov-gm0148", "nl-ov-gm0160", "nl-ov-gm0158", "nl-ov-gm0164",
			"nl-ov-gm0168", "nl-ov-gm0173", "nl-ov-gm0163", "nl-ov-gm0175",
			"nl-ov-gm0177", "nl-ov-gm0180", "nl-ge-gm0200", "nl-ge-gm0202",
			"nl-ge-gm1705", "nl-ge-gm0241", "nl-ge-gm0252", "nl-ge-gm0265",
			"nl-ge-gm0213", "nl-ge-gm0277", "nl-3559-gm0352", "nl-ge-gm0216",
			"nl-ge-gm0236", "nl-ge-gm0281", "nl-ge-gm0275", "nl-ge-gm0293",
			"nl-ge-gm0225", "nl-ge-gm0296", "nl-ge-gm0299", "nl-ge-gm0222",
			"nl-3559-gm0339", "nl-ge-gm0279", "nl-ge-gm0228", "nl-3559-gm0340",
			"nl-ge-gm0289", "nl-3559-gm0344", "nl-3559-gm0312", "nl-3559-gm0321",
			"nl-3559-gm0335", "nl-3559-gm0353", "nl-3559-gm0351", "nl-3559-gm0355",
			"nl-3557-gm0393", "nl-3557-gm0365", "nl-3557-gm0370", "nl-3560-gm0534",
			"nl-3557-gm0383", "nl-3557-gm0361", "nl-3557-gm0416", "nl-3557-gm0439",
			"nl-3557-gm0880", "nl-3557-gm0400", "nl-3557-gm0385", "nl-3557-gm0478",
			"nl-3557-gm0396", "nl-3560-gm0484", "nl-3560-gm0499", "nl-ge-gm0297",
			"nl-3560-gm0512", "nl-3558-gm0797", "nl-3558-gm0865", "nl-3560-gm0482",
			"nl-3560-gm0531", "nl-3560-gm0537", "nl-3560-gm0545", "nl-3560-gm0546",
			"nl-3560-gm0553", "nl-3560-gm0569", "nl-3557-gm0473", "nl-3560-gm0576",
			"nl-3560-gm0489", "nl-3560-gm0610", "nl-3560-gm0505", "nl-3560-gm0590",
			"nl-3560-gm0503", "nl-3560-gm1892", "nl-3560-gm0644", "nl-3560-gm0623",
			"nl-3560-gm0491", "nl-3560-gm0608", "nl-3560-gm0611", "nl-3560-gm0613",
			"nl-3559-gm0331", "nl-3560-gm0620", "nl-3560-gm0707", "nl-3559-gm0356",
			"nl-3560-gm0622", "nl-3560-gm0626", "nl-3560-gm0547", "nl-3560-gm0638",
			"nl-3560-gm0642", "nl-3560-gm0597", "nl-3560-gm0542", "nl-3560-gm0643",
			"nl-3560-gm0502", "nl-3560-gm0513", "nl-ge-gm0263", "nl-ge-gm0668",
			"nl-ge-gm0733", "nl-ge-gm0304", "nl-3559-gm1904", "nl-3558-gm0753",
			"nl-3558-gm0772", "nl-3558-gm0848", "nl-3558-gm0855", "nl-3558-gm0766",
			"nl-3558-gm0784", "nl-3558-gm0779", "nl-3558-gm0785", "nl-3558-gm0796",
			"nl-3558-gm0798", "nl-3558-gm1667", "nl-3558-gm0823", "nl-3558-gm1728",
			"nl-3558-gm1659", "nl-3558-gm0820", "nl-3558-gm0846", "nl-3558-gm0845",
			"nl-3558-gm0794", "nl-3558-gm1652", "nl-3558-gm0847", "nl-3557-gm0852",
			"nl-3558-gm0815", "nl-3558-gm1685", "nl-3558-gm0786", "nl-3558-gm0856",
			"nl-3558-gm0858", "nl-3558-gm0757", "nl-3558-gm1724", "nl-3558-gm0861",
			"nl-3558-gm0866", "nl-3558-gm0867", "nl-3558-gm0870", "nl-3558-gm0874",
			"nl-3558-gm0738", "nl-li-gm0889", "nl-li-gm0899", "nl-li-gm0881",
			"nl-li-gm0882", "nl-li-gm0917", "nl-li-gm0888", "nl-li-gm0971",
			"nl-li-gm1883", "nl-li-gm0938", "nl-li-gm0962", "nl-li-gm1903",
			"nl-li-gm0935", "nl-li-gm0994", "nl-li-gm0986", "nl-3560-gm1525",
			"nl-3559-gm0345", "nl-3559-gm1581", "nl-li-gm0984", "nl-3558-gm1658",
			"nl-li-gm1669", "nl-li-gm1641", "nl-li-gm0957", "nl-3560-gm0627",
			"nl-3560-gm1672", "nl-3560-gm1621", "nl-3560-gm0637", "nl-3558-gm0873",
			"nl-gr-gm0018", "nl-li-gm0907", "nl-3558-gm0756", "nl-3558-gm1684",
			"nl-3557-gm1696", "nl-3559-gm0310", "nl-dr-gm1699", "nl-ov-gm1700",
			"nl-dr-gm0118", "nl-dr-gm1701", "nl-dr-gm1731", "nl-3558-gm1702",
			"nl-3558-gm0755", "nl-ge-gm0196", "nl-ge-gm0226", "nl-li-gm0965",
			"nl-li-gm1729", "nl-gr-gm1730", "nl-ge-gm1740", "nl-ge-gm0262",
			"nl-ov-gm1742", "nl-ov-gm0150", "nl-3558-gm1771", "nl-ge-gm0285",
			"nl-ov-gm1773", "nl-ge-gm1876", "nl-3560-gm1884", "nl-3558-gm0743",
			"nl-li-gm1894", "nl-3558-gm0762", "nl-3560-gm1916", "nl-3560-gm0568",
			"nl-3560-gm1926", "nl-3560-gm1927", "nl-3557-gm0498", "nl-3560-gm0530",
			"nl-3560-gm0501", "nl-ze-gm0703", "nl-3558-gm0840", "nl-3558-gm0879",
			"nl-li-gm0928", "nl-li-gm1711", "nl-gr-gm0037", "nl-dr-gm1680",
			"nl-gr-gm0047", "nl-fr-gm0080", "nl-fr-gm0081", "nl-fr-gm0098",
			"nl-dr-gm0109", "nl-ov-gm0147", "nl-ov-gm0141", "nl-ov-gm0189",
			"nl-ge-gm0214", "nl-ge-gm0209", "nl-ge-gm0246", "nl-ge-gm0221",
			"nl-ge-gm0268", "nl-ge-gm0282", "nl-ge-gm1955", "nl-ge-gm0301",
			"nl-3559-gm0327", "nl-3559-gm0342", "nl-3557-gm0399", "nl-3557-gm0397",
			"nl-3560-gm0575", "nl-3560-gm0579", "nl-3559-gm0589", "nl-3560-gm0603",
			"nl-fr-gm0737", "nl-3558-gm0770", "nl-3558-gm0809", "nl-3558-gm0788",
			"nl-3558-gm0824", "nl-3558-gm0777", "nl-3558-gm0860", "nl-li-gm0944",
			"nl-li-gm0946", "nl-li-gm1507", "nl-li-gm0893", "nl-3558-gm1706",
			"nl-gr-gm0048", "nl-dr-gm1681", "nl-dr-gm1690", "nl-ge-gm1734",
			"nl-li-gm0983", "nl-ge-gm1509", "nl-ov-gm0183", "nl-ge-gm0294",
			"nl-li-gm0988", "nl-fr-gm0085", "nl-dr-gm0106", "nl-ov-gm1735",
			"nl-3557-gm0450", "nl-3558-gm0844", "nl-gr-gm0017", "nl-3560-gm0606",
			"nl-fr-gm0074", "nl-li-gm0951", "nl-3557-gm0458", "nl-fr-gm0060",
			"nl-dr-gm0114", "nl-li-gm0981", "nl-ge-gm0274", "nl-dr-gm0119"
		))
	}

	def createEuropeCountryCounts(): iMap[String, Int] = {
		mapToRandom(List(
			"AL", "AD", "AT", "BY", "BE", "BA", "BG", "HR", "CY", "CZ",
			"DK", "EE", "FO", "FI", "FR", "DE", "GI", "GR", "HU", "IS",
			"IE", "IT", "LV", "LI", "LT", "LU", "MK", "MT", "MD", "MC",
			"NL", "NO", "PL", "PT", "RO", "SM", "RS", "SK", "SI", "ES",
			"SE", "CH", "UA", "GB", "VA", "RS", "IM", "RS", "ME"))
	}

	def createWorldCountryCounts(): iMap[String, Int] = {
		mapToRandom(List(
			"AD", "AE", "AF", "AG", "AI", "AL", "AM", "AO", "AQ", "AR",
			"AS", "AT", "AU", "AW", "AX", "AZ", "BA", "BB", "BD", "BE",
			"BF", "BG", "BH", "BI", "BJ", "BL", "BM", "BN", "BO", "BQ",
			"BR", "BS", "BT", "BV", "BW", "BY", "BZ", "CA", "CC", "CD",
			"CF", "CG", "CH", "CI", "CK", "CL", "CM", "CN", "CO", "CR",
			"CU", "CV", "CW", "CX", "CY", "CZ", "DE", "DJ", "DK", "DM",
			"DO", "DZ", "EC", "EE", "EG", "EH", "ER", "ES", "ET", "FI",
			"FJ", "FK", "FM", "FO", "FR", "GA", "GB", "GD", "GE", "GF",
			"GG", "GH", "GI", "GL", "GM", "GN", "GP", "GQ", "GR", "GS",
			"GT", "GU", "GW", "GY", "HK", "HM", "HN", "HR", "HT", "HU",
			"ID", "IE", "IL", "IM", "IN", "IO", "IQ", "IR", "IS", "IT",
			"JE", "JM", "JO", "JP", "KE", "KG", "KH", "KI", "KM", "KN",
			"KP", "KR", "KW", "KY", "KZ", "LA", "LB", "LC", "LI", "LK",
			"LR", "LS", "LT", "LU", "LV", "LY", "MA", "MC", "MD", "ME",
			"MF", "MG", "MH", "MK", "ML", "MM", "MN", "MO", "MP", "MQ",
			"MR", "MS", "MT", "MU", "MV", "MW", "MX", "MY", "MZ", "NA",
			"NC", "NE", "NF", "NG", "NI", "NL", "NO", "NP", "NR", "NU",
			"NZ", "OM", "PA", "PE", "PF", "PG", "PH", "PK", "PL", "PM",
			"PN", "PR", "PS", "PT", "PW", "PY", "QA", "RE", "RO", "RS",
			"RU", "RW", "SA", "SB", "SC", "SD", "SE", "SG", "SH", "SI",
			"SJ", "SK", "SL", "SM", "SN", "SO", "SR", "SS", "ST", "SV",
			"SX", "SY", "SZ", "TC", "TD", "TF", "TG", "TH", "TJ", "TK",
			"TL", "TM", "TN", "TO", "TR", "TT", "TV", "TW", "TZ", "UA",
			"UG", "UM", "US", "UY", "UZ", "VA", "VC", "VE", "VG", "VI",
			"VN", "VU", "WF", "WS", "YE", "YT", "ZA", "ZM", "ZW"))
	}

	def getNLMapConversion(): Map[String, String] = {
		Map("schiermonnikoog" -> "nl-fr-gm0088",
			"amsterdam" -> "nl-3557-gm0363",
			"texel" -> "nl-3557-gm0448",
			"eemsmond" -> "nl-gr-gm1651",
			"schouwen-duiveland" -> "nl-ze-gm1676",
			"súdwest-fryslân" -> "nl-fr-gm1900",
			"goeree-overflakkee" -> "nl-3560-gm1924",
			"bellingwedde" -> "nl-gr-gm0007",
			"zeewolde" -> "nl-fl-gm0050",
			"almere" -> "nl-fl-gm0034",
			"nijkerk" -> "nl-ge-gm0267",
			"barneveld" -> "nl-ge-gm0203",
			"amersfoort" -> "nl-3559-gm0307",
			"baarn" -> "nl-3559-gm0308",
			"opmeer" -> "nl-3557-gm0432",
			"hollands kroon" -> "nl-3557-gm1911",
			"heerhugowaard" -> "nl-3557-gm0398",
			"enschede" -> "nl-ov-gm0153",
			"haarlemmermeer" -> "nl-3557-gm0394",
			"aalsmeer" -> "nl-3557-gm0358",
			"binnenmaas" -> "nl-3560-gm0585",
			"strijen" -> "nl-3560-gm0617",
			"wassenaar" -> "nl-3560-gm0629",
			"hardinxveld-giessendam" -> "nl-3560-gm0523",
			"giessenlanden" -> "nl-3560-gm0689",
			"leudal" -> "nl-li-gm1640",
			"oss" -> "nl-3558-gm0828",
			"bernheze" -> "nl-3558-gm1721",
			"woerden" -> "nl-3559-gm0632",
			"bodegraven-reeuwijk" -> "nl-3560-gm1901",
			"rotterdam" -> "nl-3560-gm0599",
			"spijkenisse" -> "nl-3560-gm0612",
			"westvoorne" -> "nl-3560-gm0614",
			"dinkelland" -> "nl-ov-gm1774",
			"oost gelre" -> "nl-ge-gm1586",
			"aalten" -> "nl-ge-gm0197",
			"berkelland" -> "nl-ge-gm1859",
			"kollumerland en nieuwkruisland" -> "nl-fr-gm0079",
			"dongeradeel" -> "nl-fr-gm0058",
			"harlingen" -> "nl-fr-gm0072",
			"terschelling" -> "nl-fr-gm0093",
			"kampen" -> "nl-ov-gm0166",
			"zwolle" -> "nl-ov-gm0193",
			"hattem" -> "nl-ge-gm0244",
			"oldebroek" -> "nl-ge-gm0269",
			"noordoostpolder" -> "nl-fl-gm0171",
			"urk" -> "nl-fl-gm0184",
			"steenwijkerland" -> "nl-ov-gm1708",
			"dronten" -> "nl-fl-gm0303",
			"nunspeet" -> "nl-ge-gm0302",
			"haarlem" -> "nl-3557-gm0392",
			"zaanstad" -> "nl-3557-gm0479",
			"oostzaan" -> "nl-3557-gm0431",
			"ouder-amstel" -> "nl-3557-gm0437",
			"de ronde venen" -> "nl-3559-gm0736",
			"laren" -> "nl-3557-gm0417",
			"blaricum" -> "nl-3557-gm0376",
			"eemnes" -> "nl-3559-gm0317",
			"medemblik" -> "nl-3557-gm0420",
			"hoorn" -> "nl-3557-gm0405",
			"koggenland" -> "nl-3557-gm1598",
			"muiden" -> "nl-3557-gm0424",
			"velsen" -> "nl-3557-gm0453",
			"beverwijk" -> "nl-3557-gm0375",
			"goes" -> "nl-ze-gm0664",
			"borsele" -> "nl-ze-gm0654",
			"noord-beveland" -> "nl-ze-gm1695",
			"middelburg" -> "nl-ze-gm0687",
			"hulst" -> "nl-ze-gm0677",
			"bergen op zoom" -> "nl-3558-gm0748",
			"tholen" -> "nl-ze-gm0716",
			"veere" -> "nl-ze-gm0717",
			"alphen-chaam" -> "nl-3558-gm1723",
			"baarle-nassau" -> "nl-3558-gm0744",
			"lelystad" -> "nl-fl-gm0995",
			"enkhuizen" -> "nl-3557-gm0388",
			"bedum" -> "nl-gr-gm0005",
			"de marne" -> "nl-gr-gm1663",
			"winsum" -> "nl-gr-gm0053",
			"zuidhorn" -> "nl-gr-gm0056",
			"moerdijk" -> "nl-3558-gm1709",
			"halderberge" -> "nl-3558-gm1655",
			"drimmelen" -> "nl-3558-gm1719",
			"oldambt" -> "nl-gr-gm1895",
			"menterwolde" -> "nl-gr-gm1987",
			"slochteren" -> "nl-gr-gm0040",
			"littenseradiel" -> "nl-fr-gm0140",
			"boarnsterhim" -> "nl-fr-gm0055",
			"skarsterlân" -> "nl-fr-gm0051",
			"gaasterlân-sleat" -> "nl-fr-gm0653",
			"maasdonk" -> "nl-3558-gm1671",
			"delfzijl" -> "nl-gr-gm0010",
			"loppersum" -> "nl-gr-gm0024",
			"appingedam" -> "nl-gr-gm0003",
			"dantumadiel" -> "nl-fr-gm1891",
			"ferwerderadiel" -> "nl-fr-gm1722",
			"vlieland" -> "nl-fr-gm0096",
			"zwartewaterland" -> "nl-ov-gm1896",
			"epe" -> "nl-ge-gm0232",
			"lemsterland" -> "nl-fr-gm0082",
			"elburg" -> "nl-ge-gm0230",
			"harderwijk" -> "nl-ge-gm0243",
			"ermelo" -> "nl-ge-gm0233",
			"putten" -> "nl-ge-gm0273",
			"bunschoten" -> "nl-3559-gm0313",
			"uithoorn" -> "nl-3557-gm0451",
			"amstelveen" -> "nl-3557-gm0362",
			"landsmeer" -> "nl-3557-gm0415",
			"diemen" -> "nl-3557-gm0384",
			"stede broec" -> "nl-3557-gm0532",
			"weesp" -> "nl-3557-gm0457",
			"naarden" -> "nl-3557-gm0425",
			"bussum" -> "nl-3557-gm0381",
			"hilversum" -> "nl-3557-gm0402",
			"huizen" -> "nl-3557-gm0406",
			"bloemendaal" -> "nl-3557-gm0377",
			"korendijk" -> "nl-3560-gm0588",
			"oud-beijerland" -> "nl-3560-gm0584",
			"vlissingen" -> "nl-ze-gm0718",
			"kapelle" -> "nl-ze-gm0678",
			"terneuzen" -> "nl-ze-gm0715",
			"sluis" -> "nl-ze-gm1714",
			"steenbergen" -> "nl-3558-gm0851",
			"roosendaal" -> "nl-3558-gm1674",
			"oosterhout" -> "nl-3558-gm0826",
			"breda" -> "nl-3558-gm0758",
			"westland" -> "nl-3560-gm1783",
			"'s-gravenhage" -> "nl-3560-gm0518",
			"maassluis" -> "nl-3560-gm0556",
			"midden-delfland" -> "nl-3560-gm1842",
			"pekela" -> "nl-gr-gm0765",
			"franekeradeel" -> "nl-fr-gm0070",
			"bergen (nh,)" -> "nl-3557-gm0373",
			"schagen" -> "nl-3557-gm0441",
			"ten boer" -> "nl-gr-gm0009",
			"groningen" -> "nl-gr-gm0014",
			"achtkarspelen" -> "nl-fr-gm0059",
			"menameradiel" -> "nl-fr-gm1908",
			"het bildt" -> "nl-fr-gm0063",
			"leek" -> "nl-gr-gm0022",
			"opsterland" -> "nl-fr-gm0086",
			"grootegast" -> "nl-gr-gm0015",
			"smallingerland" -> "nl-fr-gm0090",
			"marum" -> "nl-gr-gm0025",
			"dalfsen" -> "nl-ov-gm0148",
			"hardenberg" -> "nl-ov-gm0160",
			"haaksbergen" -> "nl-ov-gm0158",
			"hengelo" -> "nl-ov-gm0164",
			"losser" -> "nl-ov-gm0168",
			"oldenzaal" -> "nl-ov-gm0173",
			"hellendoorn" -> "nl-ov-gm0163",
			"ommen" -> "nl-ov-gm0175",
			"raalte" -> "nl-ov-gm0177",
			"staphorst" -> "nl-ov-gm0180",
			"apeldoorn" -> "nl-ge-gm0200",
			"arnhem" -> "nl-ge-gm0202",
			"lingewaard" -> "nl-ge-gm1705",
			"groesbeek" -> "nl-ge-gm0241",
			"heumen" -> "nl-ge-gm0252",
			"millingen aan de rijn" -> "nl-ge-gm0265",
			"brummen" -> "nl-ge-gm0213",
			"rozendaal" -> "nl-ge-gm0277",
			"wijk bij duurstede" -> "nl-3559-gm0352",
			"culemborg" -> "nl-ge-gm0216",
			"geldermalsen" -> "nl-ge-gm0236",
			"tiel" -> "nl-ge-gm0281",
			"rheden" -> "nl-ge-gm0275",
			"westervoort" -> "nl-ge-gm0293",
			"druten" -> "nl-ge-gm0225",
			"wijchen" -> "nl-ge-gm0296",
			"zevenaar" -> "nl-ge-gm0299",
			"doetinchem" -> "nl-ge-gm0222",
			"renswoude" -> "nl-3559-gm0339",
			"scherpenzeel" -> "nl-ge-gm0279",
			"ede" -> "nl-ge-gm0228",
			"rhenen" -> "nl-3559-gm0340",
			"wageningen" -> "nl-ge-gm0289",
			"utrecht" -> "nl-3559-gm0344",
			"bunnik" -> "nl-3559-gm0312",
			"houten" -> "nl-3559-gm0321",
			"montfoort" -> "nl-3559-gm0335",
			"ijsselstein" -> "nl-3559-gm0353",
			"woudenberg" -> "nl-3559-gm0351",
			"zeist" -> "nl-3559-gm0355",
			"haarlemmerliede en spaarnwoude" -> "nl-3557-gm0393",
			"graft-de rijp" -> "nl-3557-gm0365",
			"beemster" -> "nl-3557-gm0370",
			"hillegom" -> "nl-3560-gm0534",
			"castricum" -> "nl-3557-gm0383",
			"alkmaar" -> "nl-3557-gm0361",
			"langedijk" -> "nl-3557-gm0416",
			"purmerend" -> "nl-3557-gm0439",
			"wormerland" -> "nl-3557-gm0880",
			"den helder" -> "nl-3557-gm0400",
			"edam-volendam" -> "nl-3557-gm0385",
			"zeevang" -> "nl-3557-gm0478",
			"heemskerk" -> "nl-3557-gm0396",
			"alphen aan den rijn" -> "nl-3560-gm0484",
			"boskoop" -> "nl-3560-gm0499",
			"zaltbommel" -> "nl-ge-gm0297",
			"gorinchem" -> "nl-3560-gm0512",
			"heusden" -> "nl-3558-gm0797",
			"vught" -> "nl-3558-gm0865",
			"alblasserdam" -> "nl-3560-gm0482",
			"hendrik-ido-ambacht" -> "nl-3560-gm0531",
			"katwijk" -> "nl-3560-gm0537",
			"leerdam" -> "nl-3560-gm0545",
			"leiden" -> "nl-3560-gm0546",
			"lisse" -> "nl-3560-gm0553",
			"nieuwkoop" -> "nl-3560-gm0569",
			"zandvoort" -> "nl-3557-gm0473",
			"noordwijkerhout" -> "nl-3560-gm0576",
			"barendrecht" -> "nl-3560-gm0489",
			"sliedrecht" -> "nl-3560-gm0610",
			"dordrecht" -> "nl-3560-gm0505",
			"papendrecht" -> "nl-3560-gm0590",
			"delft" -> "nl-3560-gm0503",
			"zuidplas" -> "nl-3560-gm1892",
			"ouderkerk" -> "nl-3560-gm0644",
			"vlist" -> "nl-3560-gm0623",
			"bergambacht" -> "nl-3560-gm0491",
			"schoonhoven" -> "nl-3560-gm0608",
			"cromstrijen" -> "nl-3560-gm0611",
			"albrandswaard" -> "nl-3560-gm0613",
			"lopik" -> "nl-3559-gm0331",
			"vianen" -> "nl-3560-gm0620",
			"zederik" -> "nl-3560-gm0707",
			"nieuwegein" -> "nl-3559-gm0356",
			"vlaardingen" -> "nl-3560-gm0622",
			"voorschoten" -> "nl-3560-gm0626",
			"leiderdorp" -> "nl-3560-gm0547",
			"zoeterwoude" -> "nl-3560-gm0638",
			"zwijndrecht" -> "nl-3560-gm0642",
			"ridderkerk" -> "nl-3560-gm0597",
			"krimpen aan den ijssel" -> "nl-3560-gm0542",
			"nederlek" -> "nl-3560-gm0643",
			"capelle aan den ijssel" -> "nl-3560-gm0502",
			"gouda" -> "nl-3560-gm0513",
			"maasdriel" -> "nl-ge-gm0263",
			"west maas en waal" -> "nl-ge-gm0668",
			"lingewaal" -> "nl-ge-gm0733",
			"neerijnen" -> "nl-ge-gm0304",
			"stichtse vecht" -> "nl-3559-gm1904",
			"best" -> "nl-3558-gm0753",
			"eindhoven" -> "nl-3558-gm0772",
			"son en breugel" -> "nl-3558-gm0848",
			"tilburg" -> "nl-3558-gm0855",
			"dongen" -> "nl-3558-gm0766",
			"gilze en rijen" -> "nl-3558-gm0784",
			"geertruidenberg" -> "nl-3558-gm0779",
			"goirle" -> "nl-3558-gm0785",
			"'s-hertogenbosch" -> "nl-3558-gm0796",
			"hilvarenbeek" -> "nl-3558-gm0798",
			"reusel-de mierden" -> "nl-3558-gm1667",
			"oirschot" -> "nl-3558-gm0823",
			"bladel" -> "nl-3558-gm1728",
			"laarbeek" -> "nl-3558-gm1659",
			"nuenen, gerwen en nederwetten" -> "nl-3558-gm0820",
			"sint-oedenrode" -> "nl-3558-gm0846",
			"sint-michielsgestel" -> "nl-3558-gm0845",
			"helmond" -> "nl-3558-gm0794",
			"gemert-bakel" -> "nl-3558-gm1652",
			"someren" -> "nl-3558-gm0847",
			"waterland" -> "nl-3557-gm0852",
			"mill en sint hubert" -> "nl-3558-gm0815",
			"landerd" -> "nl-3558-gm1685",
			"grave" -> "nl-3558-gm0786",
			"uden" -> "nl-3558-gm0856",
			"valkenswaard" -> "nl-3558-gm0858",
			"boxtel" -> "nl-3558-gm0757",
			"bergeijk" -> "nl-3558-gm1724",
			"veldhoven" -> "nl-3558-gm0861",
			"waalre" -> "nl-3558-gm0866",
			"waalwijk" -> "nl-3558-gm0867",
			"werkendam" -> "nl-3558-gm0870",
			"woudrichem" -> "nl-3558-gm0874",
			"aalburg" -> "nl-3558-gm0738",
			"beesel" -> "nl-li-gm0889",
			"brunssum" -> "nl-li-gm0899",
			"onderbanken" -> "nl-li-gm0881",
			"landgraaf" -> "nl-li-gm0882",
			"heerlen" -> "nl-li-gm0917",
			"beek" -> "nl-li-gm0888",
			"stein" -> "nl-li-gm0971",
			"sittard-geleen" -> "nl-li-gm1883",
			"meerssen" -> "nl-li-gm0938",
			"schinnen" -> "nl-li-gm0962",
			"eijsden-margraten" -> "nl-li-gm1903",
			"maastricht" -> "nl-li-gm0935",
			"valkenburg aan de geul" -> "nl-li-gm0994",
			"voerendaal" -> "nl-li-gm0986",
			"teylingen" -> "nl-3560-gm1525",
			"veenendaal" -> "nl-3559-gm0345",
			"utrechtse heuvelrug" -> "nl-3559-gm1581",
			"venray" -> "nl-li-gm0984",
			"heeze-leende" -> "nl-3558-gm1658",
			"roerdalen" -> "nl-li-gm1669",
			"maasgouw" -> "nl-li-gm1641",
			"roermond" -> "nl-li-gm0957",
			"waddinxveen" -> "nl-3560-gm0627",
			"rijnwoude" -> "nl-3560-gm1672",
			"lansingerland" -> "nl-3560-gm1621",
			"zoetermeer" -> "nl-3560-gm0637",
			"woensdrecht" -> "nl-3558-gm0873",
			"hoogezand-sappemeer" -> "nl-gr-gm0018",
			"gennep" -> "nl-li-gm0907",
			"boxmeer" -> "nl-3558-gm0756",
			"cuijk" -> "nl-3558-gm1684",
			"wijdemeren" -> "nl-3557-gm1696",
			"de bilt" -> "nl-3559-gm0310",
			"noordenveld" -> "nl-dr-gm1699",
			"twenterand" -> "nl-ov-gm1700",
			"hoogeveen" -> "nl-dr-gm0118",
			"westerveld" -> "nl-dr-gm1701",
			"midden-drenthe" -> "nl-dr-gm1731",
			"sint anthonis" -> "nl-3558-gm1702",
			"boekel" -> "nl-3558-gm0755",
			"rijnwaarden" -> "nl-ge-gm0196",
			"duiven" -> "nl-ge-gm0226",
			"simpelveld" -> "nl-li-gm0965",
			"gulpen-wittem" -> "nl-li-gm1729",
			"tynaarlo" -> "nl-gr-gm1730",
			"neder-betuwe" -> "nl-ge-gm1740",
			"lochem" -> "nl-ge-gm0262",
			"rijssen-holten" -> "nl-ov-gm1742",
			"deventer" -> "nl-ov-gm0150",
			"geldrop-mierlo" -> "nl-3558-gm1771",
			"voorst" -> "nl-ge-gm0285",
			"olst-wijhe" -> "nl-ov-gm1773",
			"bronckhorst" -> "nl-ge-gm1876",
			"kaag en braassem" -> "nl-3560-gm1884",
			"asten" -> "nl-3558-gm0743",
			"peel en maas" -> "nl-li-gm1894",
			"deurne" -> "nl-3558-gm0762",
			"leidschendam-voorburg" -> "nl-3560-gm1916",
			"bernisse" -> "nl-3560-gm0568",
			"pijnacker-nootdorp" -> "nl-3560-gm1926",
			"molenwaard" -> "nl-3560-gm1927",
			"drechterland" -> "nl-3557-gm0498",
			"hellevoetsluis" -> "nl-3560-gm0530",
			"brielle" -> "nl-3560-gm0501",
			"reimerswaal" -> "nl-ze-gm0703",
			"rucphen" -> "nl-3558-gm0840",
			"zundert" -> "nl-3558-gm0879",
			"kerkrade" -> "nl-li-gm0928",
			"echt-susteren" -> "nl-li-gm1711",
			"stadskanaal" -> "nl-gr-gm0037",
			"aa en hunze" -> "nl-dr-gm1680",
			"veendam" -> "nl-gr-gm0047",
			"leeuwarden" -> "nl-fr-gm0080",
			"leeuwarderadeel" -> "nl-fr-gm0081",
			"weststellingwerf" -> "nl-fr-gm0098",
			"coevorden" -> "nl-dr-gm0109",
			"borne" -> "nl-ov-gm0147",
			"almelo" -> "nl-ov-gm0141",
			"wierden" -> "nl-ov-gm0189",
			"buren" -> "nl-ge-gm0214",
			"beuningen" -> "nl-ge-gm0209",
			"heerde" -> "nl-ge-gm0246",
			"doesburg" -> "nl-ge-gm0221",
			"nijmegen" -> "nl-ge-gm0268",
			"ubbergen" -> "nl-ge-gm0282",
			"montferland" -> "nl-ge-gm1955",
			"zutphen" -> "nl-ge-gm0301",
			"leusden" -> "nl-3559-gm0327",
			"soest" -> "nl-3559-gm0342",
			"heiloo" -> "nl-3557-gm0399",
			"heemstede" -> "nl-3557-gm0397",
			"noordwijk" -> "nl-3560-gm0575",
			"oegstgeest" -> "nl-3560-gm0579",
			"oudewater" -> "nl-3559-gm0589",
			"rijswijk" -> "nl-3560-gm0603",
			"tytsjerksteradiel" -> "nl-fr-gm0737",
			"eersel" -> "nl-3558-gm0770",
			"loon op zand" -> "nl-3558-gm0809",
			"haaren" -> "nl-3558-gm0788",
			"oisterwijk" -> "nl-3558-gm0824",
			"etten-leur" -> "nl-3558-gm0777",
			"veghel" -> "nl-3558-gm0860",
			"mook en middelaar" -> "nl-li-gm0944",
			"nederweert" -> "nl-li-gm0946",
			"horst aan de maas" -> "nl-li-gm1507",
			"bergen (l,)" -> "nl-li-gm0893",
			"cranendonck" -> "nl-3558-gm1706",
			"vlagtwedde" -> "nl-gr-gm0048",
			"borger-odoorn" -> "nl-dr-gm1681",
			"de wolden" -> "nl-dr-gm1690",
			"overbetuwe" -> "nl-ge-gm1734",
			"venlo" -> "nl-li-gm0983",
			"oude ijsselstreek" -> "nl-ge-gm1509",
			"tubbergen" -> "nl-ov-gm0183",
			"winterswijk" -> "nl-ge-gm0294",
			"weert" -> "nl-li-gm0988",
			"ooststellingwerf" -> "nl-fr-gm0085",
			"assen" -> "nl-dr-gm0106",
			"hof van twente" -> "nl-ov-gm1735",
			"uitgeest" -> "nl-3557-gm0450",
			"schijndel" -> "nl-3558-gm0844",
			"haren" -> "nl-gr-gm0017",
			"schiedam" -> "nl-3560-gm0606",
			"heerenveen" -> "nl-fr-gm0074",
			"nuth" -> "nl-li-gm0951",
			"schermer" -> "nl-3557-gm0458",
			"ameland" -> "nl-fr-gm0060",
			"emmen" -> "nl-dr-gm0114",
			"vaals" -> "nl-li-gm0981",
			"renkum" -> "nl-ge-gm0274",
			"meppel" -> "nl-dr-gm0119")
	}

	def getValueMapFromFile(filename: String): Map[String, String] = {
		scala.io.Source.fromFile("citymunicipality.txt")
			.getLines().toArray[String]
			.map(c => c.split(";"))
			.map(a => (a(0), a(1)))
			.toMap[String, String]
	}

	def getCityMunicipalityMapping(): Map[String, String] = {
		getValueMapFromFile("citymunicipality.txt")
	}

	def mapToRandom[T](list: List[T]): iMap[T, Int] = {
		val random = new Random()
		list.map(elem => (elem, random.nextInt(1000))).toMap[T, Int]
	}

	def formatEuro(amount: Float): String = {
		lazy val formatter = {
			val formatter = NumberFormat.getInstance(Locale.US).asInstanceOf[DecimalFormat]
			formatter.setMaximumFractionDigits(2)
			formatter.setMinimumFractionDigits(2)

			val symbols = formatter.getDecimalFormatSymbols()
			symbols.setGroupingSeparator('.')
			symbols.setDecimalSeparator(',')
			formatter.setDecimalFormatSymbols(symbols)

			formatter
		}

		"€ " + formatter.format(amount)
	}

	def round(value: Float, decimals: Int): Float = {
		BigDecimal(value).setScale(decimals, BigDecimal.RoundingMode.HALF_UP).toFloat
	}

	def round(value: Double, decimals: Int): Double = {
		BigDecimal(value).setScale(decimals, BigDecimal.RoundingMode.HALF_UP).toDouble
	}
}